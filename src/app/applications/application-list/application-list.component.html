<div class="application-list">
    <div class="spinner-container" *ngIf="loading" [@visibility]>
        <div class="spinner-new rotating"></div>
    </div>
        
    <h1 class="sr-only">Public Review and Comment Application List</h1>

    <!-- APPLICATION LIST VIEW -->
    <div class="list-container" *ngIf="!loading">
        <div class="list-container-options">
            <mat-slide-toggle color="primary" [checked]="showOnlyOpenApps" (change)="showOnlyOpenApps = $event.checked; applyFilters($event)">
                Only show applications with an open or future comment period
            </mat-slide-toggle>
        </div>

        <div class="list-group">
            <div class="d-block w-100 text-center py-3" *ngIf="!appsCount()">
                <em>No matching applications found.</em>
            </div>

            <ng-template ngFor let-item [ngForOf]="filteredApps">
                <div *ngIf="item.isVisible" class="list-group-item list-group-item-action" [class.active]="isCurrentApp(item)" (click)="setCurrentApp(item)">
                    <h2>{{item.client || 'Unknown Client'}}</h2>
                    <span class="badge" [ngClass]="{'badge-primary'   : commentPeriodService.isNotStarted(item.currentPeriod),
                                                    'badge-secondary' : commentPeriodService.isNotOpen(item.currentPeriod),
                                                    'badge-danger'    : commentPeriodService.isClosed(item.currentPeriod),
                                                    'badge-success'   : commentPeriodService.isOpen(item.currentPeriod)}">
                        {{item.cpStatus}}
                        <div *ngIf="item.currentPeriod">
                            {{item.currentPeriod.startDate | date:'mediumDate'}} - {{item.currentPeriod.endDate | date:'mediumDate'}}
                        </div>
                    </span>
                    <ul class="nv-list">
                        <li>
                            <span class="nv-list__item--name">Status</span>
                            <span class="nv-list__item--value">{{item.appStatus}}</span>
                        </li>
                        <li class="nv-list_item">
                            <span class="nv-list__item--name">Purpose</span>
                            <span class="nv-list__item--value" *ngIf="item.purpose && item.subpurpose">
                                <span>{{item.purpose | titlecase}}</span>
                                <span>({{item.subpurpose | titlecase}})</span>
                            </span>
                            <span class="nv-list__item--value" *ngIf="!item.purpose || !item.subpurpose">-</span>
                        </li>
                        <li class="nv-list_item">
                            <span class="nv-list__item--name">Tenure Type</span>
                            <span class="nv-list__item--value" *ngIf="item.type && item.subtype">
                                <span>{{item.type | titlecase}}</span>
                                <span>({{item.subtype | titlecase}})</span>
                            </span>
                            <span class="nv-list__item--value" *ngIf="!item.type || !item.subtype">-</span>
                        </li>
                    </ul>
                    <div class="list-group-item__buttons">
                        <a (click)="$event.stopPropagation();" [routerLink]="['/a', item._id]">Go to Application Details &nbsp; &rsaquo;</a>
                    </div>
                </div>
            </ng-template>
        </div>
    </div>

    <!-- APPLICATION MAP VIEW -->
    <app-main-map class="map-container" (visibleLayer)="visibleLayer($event)"></app-main-map>
    
</div>